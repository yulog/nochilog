<b:if cond='data:view.isPost'>
<div class='related-posts-container' id='related-posts-widget'/>
<div style='clear: both;'/>
<script type='text/javascript'>
let labelArray = <b:eval expr='data:post.labels map (label =&gt; label.name)'/>;
let relatedSettings = {
blogURL:&quot;<data:blog.homepageUrl/>&quot;,
relatedHeading:&quot;&lt;h4&gt;&lt;span&gt;関連する投稿&lt;/span&gt;&lt;/h4&gt;&quot;,
relatedNotfound:&quot;&lt;li&gt;関連記事はありません&lt;/li&gt;&quot;,
relatedPosts:4,
relatedStyle:3,
thumbnailSize:&quot;w300-h200-p-k-no-nu&quot;,
thumbnailSize2x:&quot;w600-h400-p-k-no-nu&quot;,
defaultThumb:&quot;https://yulog.github.io/nochilog/image/no_thumb.svg&quot;,
roundThumbs:false,
titleLength:&quot;auto&quot;,
snippetLength:45,
centerText:false,
openNewTab:false,
currentURL:&quot;<data:post.url.canonical.https/>&quot;
};</script>
<script type='text/javascript'>
//<![CDATA[
let randomRelatedIndex,startRelated;!((a,e,b)=>{let s={callBack:()=>{}};for(let c in relatedSettings)s[c]="undefined"==relatedSettings[c]?s[c]:relatedSettings[c];const d=c=>{let a=e.createElement("script");a.type="text/javascript",a.src=c,b.appendChild(a)},f=(c,a)=>Math.floor(Math.random()*(a-c+1))+c,t=e=>{let a,f,g=e.length;if(0===g)return!1;for(;--g;)a=Math.floor(Math.random()*(g+1)),f=e[g],e[g]=e[a],e[a]=f;return e},g="object"==typeof labelArray&&0<labelArray.length?`/-/${t(labelArray)[0]}`:"",c=d=>{let a,f,h,k,x,y,z,A,B=document.getElementById("related-posts-widget"),b=t(d.feed.entry),c=s.relatedStyle,e=`${s.relatedHeading}<ul class="related-posts-${c}">`,C=s.openNewTab?" target=\"_blank\"":"",g=s.centerText?"text-align:center;":"",i=s.roundThumbs?"-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;":"",j=s.currentURL;if(B){for(let d=0;d<s.relatedPosts&&d!=b.length;d++){h=b[d].title.$t,k="auto"!==s.titleLength&&s.titleLength<h.length?`${h.substring(0,s.titleLength)}&hellip;`:h,x="media$thumbnail"in b[d]&&!1!==s.thumbnailSize?b[d].media$thumbnail.url.replace(/\/s[0-9]+(\-c)?/,`/${s.thumbnailSize}`):s.defaultThumb,z="media$thumbnail"in b[d]&&!1!==s.thumbnailSize?`<source srcset="${b[d].media$thumbnail.url.replace(/\/s[0-9]+(\-c)?/,`/${s.thumbnailSize}-rw`)}, ${b[d].media$thumbnail.url.replace(/\/s[0-9]+(\-c)?/,`/${s.thumbnailSize2x}-rw`)} 2x">`:"",A="media$thumbnail"in b[d]&&!1!==s.thumbnailSize2x?` srcset="${b[d].media$thumbnail.url.replace(/\/s[0-9]+(\-c)?/,`/${s.thumbnailSize2x}`)} 2x"`:"",a=t(b[d].published.$t);let l,m=new Date(a),n=new Intl.DateTimeFormat("en-US",{month:"long"}).format(m),o=m.getDate(),p=m.getFullYear();l=`${n} ${o} ${p}`,y="summary"in b[d]&&0<s.snippetLength?`${b[d].summary.$t.replace(/<br ?\/?>/g," ").replace(/<.*?>/g,"").replace(/[<>]/g,"").substring(0,s.snippetLength)}&hellip;`:"";for(let a=0,c=b[d].link.length;a<c;a++)f="alternate"==b[d].link[a].rel?b[d].link[a].href:"#";let q=new URL(f);f=`https://${q.host}${q.pathname}`,j==f?1==b.length&&(e+=s.relatedNotfound):1==c?e+=`<li><a href="${f}" ${C}>${k}</a></li>`:2==c?e+=`<li><a href="${f}" ${C}><div class="related-title">${k}</div></a><div class="related-snippets">${y}</div></li>`:3==c?e+=`<li class="related-post-item" style="${g}"><a href="${f}" ${C}><picture>${z}<img alt="" class="related-thumb-large" src="${x}"${A} style="${i}"></picture><div class="related-title">${k}</div><div class="related-snippets">${y}</div></a></li>`:4==c?e+=`<li class="related-post-item" style="${g}"><a href="${f}" ${C}><img alt="" class="related-thumb-large" src="${x}" style="${i}"><div class="related-title">${k}</div></a><div class="related-date">${l}</div></li>`:5==c?e+=`<li class="related-post-item" style="${g}"><a href="${f}" ${C}><img alt="" class="related-thumb-large" src="${x}" style="${i}"><div class="related-title">${k}</div></a></li>`:6==c?e+=`<li class="related-post-item"><a href="${f}" ${C}><img alt="" class="related-thumb-large" src="${x}" style="${i}"><div class="related-wrapper" style="${i}"><div class="related-wrapper-inner"><div class="related-title">${k}</div></div></div></a></li>`:7==c?e+=`<li class="related-post-item"><a href="${f}" ${C}><img alt="" class="related-thumb-large" src="${x}" style="${i}"></a></li>`:8==c?e+=`<li class="related-post-item"><a class="related-post-item-wrapper" href="${f}" ${C}><img alt="" class="related-thumb" src="${x}" style="${i}"><div class="related-title">${k}</div></a><div class="related-date">${l}</div></li>`:9==c&&(e+=`<li><a href="${f}" ${C}><img alt="" class="related-thumb" src="${x}" style="${i}"><div class="related-title">${k}</div></a><div class="related-snippets">${y}</div></li>`)}B.innerHTML=e+=`</ul>${"<span style=\"display:block;clear:both;\"></span>"}`,s.callBack()}};randomRelatedIndex=e=>{let a=e.feed.openSearch$totalResults.$t-s.relatedPosts,b=f(1,0<a?a:1);d(`${s.blogURL.replace(/\/$/,"")}/feeds/posts/summary${g}?alt=json-in-script&orderby=updated&start-index=${b}&max-results=${s.relatedPosts}&callback=startRelated`)},startRelated=c,d(`${s.blogURL.replace(/\/$/,"")}/feeds/posts/summary${g}?alt=json-in-script&orderby=updated&max-results=0&callback=randomRelatedIndex`)})(window,document,document.getElementsByTagName("head")[0]);
//]]>
</script>
</b:if>